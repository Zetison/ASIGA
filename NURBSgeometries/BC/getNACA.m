function f = getNACA(xi,t,n)
% returns the n'th derivative of NACA profile with respect to xi = sqrt(x)
if nargin < 3
    n = 0;
end
switch n
    case 0
    %     a = [0.2969; -0.1267; -0.3523; 0.2843; -0.1022]; % BeTSSi old
    %     a = [0.2969; -0.1260; -0.3516; 0.2843; -0.1015]; % std NACA
    %     a = [0.2969; -0.124955913673186; -0.355479166225243; 0.2843; -0.100764920101571];
    %     a = [0.2969; -0.126495754158552; -0.349976760493317; 0.2843; -0.104727485348132];
%             a = [0.298041753510732; -0.131982746024382; -0.328681392587664; 0.244164885960912; -0.081542500859598];
        a = [0.2969; -0.12651673270629464; -0.34981592496061949; 0.28392704804012290; -0.10449439037320877];
%             f = 5*t*(a(1)*sqrt(x)+a(2)*x+a(3)*x.^2+a(4)*x.^3+a(5)*x.^4);
        f = 5*t*(a(1)*xi+a(2)*xi.^2+a(3)*xi.^4+a(4)*xi.^6+a(5)*xi.^8);
        f(xi == 1) = 0; % for exactness...
    case 1
        a = [0.298041753510732; -0.131982746024382; -0.328681392587664; 0.244164885960912; -0.081542500859598];
        f = 5*t*(a(1)+2*a(2)*xi+4*a(3)*xi.^3+6*a(4)*xi.^5+8*a(5)*xi.^7);
    case 2
        a = [0.298041753510732; -0.131982746024382; -0.328681392587664; 0.244164885960912; -0.081542500859598];
        f = 5*t*(2*a(2)+12*a(3)*xi.^2+30*a(4)*xi.^4+56*a(5)*xi.^6);
end
% h_stp://www.pdas.com/refs/tm4741.pdf, Computer Program To Obtain Ordinates for NACA Airfoils
    
  

% x_t = 0.3; % wikipedia
% x_n = 0.1; % wikipedia
% B = [1,1,1,1,1;                                   % f(1) = 0
%      sqrt(x_n), x_n, x_n^2, x_n^3, x_n^4;        	% f(x_n) = t/2*0.78
%      sqrt(x_t), x_t, x_t^2, x_t^3, x_t^4;         % f(x_t) = t/2
%      1/(2*sqrt(x_t)), 1, 2*x_t, 3*x_t^2, 4*x_t^3; % f'(x_t) = 0
%      1/2, 1, 2, 3, 4];                            % f'(1) = -5*0.234*t
% a = B\[0; 0.078; 0.1; 0; -0.234];
% 

% 
% x_t = 0.3; % wikipedia
% B = [1,1,1,1,1;                                   % f(1) = 0
%      sqrt(x_t), x_t, x_t^2, x_t^3, x_t^4;         % f(x_t) = t/2
%      1/(2*sqrt(x_t)), 1, 2*x_t, 3*x_t^2, 4*x_t^3; % f'(x_t) = 0
%      1, 0, 0, 0, 0;                               % a0 = 0.2969
%      1/2, 1, 2, 3, 4];                            % f'(1) = -5*0.23385*t
% a = B\[0; 0.1; 0; 0.2969; -0.23385];

% 
% x_t = vpa(0.3); % wikipedia
% B = [1,1,1,1,1;                                   % f(1) = 0
%      sqrt(x_t), x_t, x_t^2, x_t^3, x_t^4;         % f(x_t) = t/2
%      1/(2*sqrt(x_t)), 1, 2*x_t, 3*x_t^2, 4*x_t^3; % f'(x_t) = 0
%      1, 0, 0, 0, 0;                               % a0 = 0.2969
%      1/2, 1, 2, 3, 4];                            % f'(1) = -5*0.23385*t
% a = B\vpa([0; 0.1; 0; vpa('0.2969'); -vpa('0.243895')]);
