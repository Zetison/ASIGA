function [s,integrand,arc] = NACAarcLengthSail(xi,a,b,g2,L,l_ls,l_us,b_ls,b_us,h_s,delta_o,alpha)
h = g2*tan(alpha./2); % = g2./tan((pi-alpha)./2)
x_s = a-58.9;
L_c = L+g2+(b-h).*cot(alpha);
t = b_ls/l_ls;
f_tu = @(xi) getNACA(xi,t,0);
f_to = @(xi) getNACA(xi,b_us/l_us,0);

df = @(xi) getNACA(xi,t,1);
df_to = @(xi) getNACA(xi,b_us/l_us,1);


df = @(xi) getNACA(xi,t,1);
integrand = @(xi) sqrt(4*xi.^2 + df(xi).^2)*l_ls;
arc = @(xi) integral(integrand,0,xi);
s = arc(xi);

g = @(xi) (cos(alpha).*sqrt(-l_ls.^2.*((l_us.^2.*xi.^4 - 2.*xi.^2.*(L_c + x_s - delta_o).*l_us + L_c.^2 + (2.*x_s - 2.*delta_o).*L_c + h_s.^2 + x_s.^2 - 2.*x_s.*delta_o + delta_o.^2).*cos(alpha).^2 - ((l_us.*xi.^2 - L_c - x_s + delta_o).^2)).*f_tu(xi).^2 + 0.2e1.*f_to(xi).*l_us.*l_ls.*(cos(alpha) - 0.1e1).*(cos(alpha) + 0.1e1).*(l_ls.*(xi.^2) - L_c - x_s).*(l_us.*xi.^2 - L_c - x_s + delta_o).*f_tu(xi) - (cos(alpha) - 0.1e1).*(cos(alpha) + 0.1e1).*(l_ls.*(xi.^2) - L_c - x_s).^2.*((l_us.^2).*f_to(xi).^2 + (h_s.^2))) + (f_tu(xi).^2.*l_ls.^2 - l_us.*l_ls.*f_to(xi).*f_tu(xi) - (delta_o + (l_us - l_ls).*(xi.^2)).*(l_ls.*(xi.^2) - L_c - x_s)).*cos(alpha).^2 + (delta_o + (l_us - l_ls).*(xi.^2)).*(l_ls.*(xi.^2) - L_c - x_s)) ./ ((f_tu(xi).^2.*l_ls.^2 - 0.2e1.*l_us.*l_ls.*f_to(xi).*f_tu(xi) + (l_us.^2).*f_to(xi).^2 + (l_us - l_ls).^2.*(xi.^4) + 0.2e1.*delta_o.*(l_us - l_ls).*(xi.^2) + (h_s.^2) + (delta_o.^2)).*cos(alpha).^2 - (delta_o + (l_us - l_ls).*(xi.^2)).^2);
dg = @(xi) -(-((l_us.^2.*xi.^4 - 2.*xi.^2.*(L_c + x_s - delta_o).*l_us + L_c.^2 + (2.*x_s - 2.*delta_o).*L_c + h_s.^2 + x_s.^2 - 2.*x_s.*delta_o + delta_o.^2).*cos(alpha).^2 - ((l_us.*xi.^2 - L_c - x_s + delta_o).^2)).*l_ls.^2.*f_tu(xi).^2 + 0.2e1.*f_to(xi).*l_us.*l_ls.*(cos(alpha) - 0.1e1).*(cos(alpha) + 0.1e1).*(l_ls.*(xi.^2) - L_c - x_s).*(l_us.*xi.^2 - L_c - x_s + delta_o).*f_tu(xi) - (cos(alpha) - 0.1e1).*(cos(alpha) + 0.1e1).*(l_ls.*(xi.^2) - L_c - x_s).^2.*((l_us.^2).*f_to(xi).^2 + (h_s.^2))).^(-0.1e1./0.2e1).*((((f_to(xi).*l_us.*l_ls.^2.*f_tu(xi).^2 - 0.2e1.*((l_us.^2).*f_to(xi).^2 - (xi.^2).*(l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls + (l_us.^2.*xi.^4) - (l_us.*(L_c + x_s - 2.*delta_o).*xi.^2) + (delta_o.^2) + ((-L_c - x_s).*delta_o) + (h_s.^2)).*l_ls.*f_tu(xi) + l_us.*((l_us.^2).*f_to(xi).^2 - l_ls.^2.*(xi.^4) + 0.2e1.*(xi.^2).*(L_c + x_s).*l_ls + (l_us.^2.*xi.^4) - (2.*xi.^2.*(L_c + x_s - delta_o).*l_us) + (delta_o.^2) + ((-2.*L_c - 2.*x_s).*delta_o) + (h_s.^2)).*f_to(xi)).*cos(alpha).^2 - ((l_us.*xi.^2) - l_ls.*(xi.^2) + delta_o).*(-0.2e1.*(l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls.*f_tu(xi) + f_to(xi).*l_us.*((l_us.*xi.^2) + l_ls.*(xi.^2) - (2.*L_c) - (2.*x_s) + delta_o))).*cos(alpha).^2.*l_ls.*df_tu(xi) + cos(alpha).^2.*l_us.*((-l_ls.^3.*f_tu(xi).^3 + 0.2e1.*f_to(xi).*l_us.*l_ls.^2.*f_tu(xi).^2 + l_ls.*(-(l_us.^2).*f_to(xi).^2 - l_ls.^2.*(xi.^4) + 0.2e1.*(xi.^2).*(L_c + x_s).*l_ls + (l_us.^2.*xi.^4) - (2.*xi.^2.*(L_c + x_s - delta_o).*l_us) + (delta_o.^2) + ((-2.*L_c - 2.*x_s).*delta_o) + (h_s.^2)).*f_tu(xi) - 0.2e1.*f_to(xi).*l_us.*((l_us.*xi.^2) - l_ls.*(xi.^2) + delta_o).*(l_ls.*(xi.^2) - L_c - x_s)).*cos(alpha).^2 + 0.2e1.*((l_us.*xi.^2) - l_ls.*(xi.^2) + delta_o).*(-l_ls.*((l_us.*xi.^2) + l_ls.*(xi.^2) - (2.*L_c) - (2.*x_s) + delta_o).*f_tu(xi)./0.2e1 + f_to(xi).*l_us.*(l_ls.*(xi.^2) - L_c - x_s))).*df_to(xi) + 0.4e1.*((((-(l_us.*xi.^2) + L_c./0.2e1 + x_s./0.2e1 - delta_o./0.2e1).*l_ls + l_us.*((l_us.*xi.^2) - L_c./0.2e1 - x_s./0.2e1 + delta_o)).*l_ls.^2.*f_tu(xi).^2 - (-l_ls.^2.*(xi.^2) + (L_c + x_s).*l_ls + (l_us.*(l_us.*xi.^2 - L_c - x_s + delta_o))).*l_us.*f_to(xi).*l_ls.*f_tu(xi) + (l_us.^2).*(-l_ls.^2.*(xi.^2) + ((l_us.*xi.^2) + L_c./0.2e1 + x_s./0.2e1 + delta_o./0.2e1).*l_ls - (l_us.*(L_c + x_s))./0.2e1).*f_to(xi).^2 - (xi.^4).*(L_c + x_s - delta_o).*l_ls.^3./0.2e1 - (-0.3e1./0.2e1.*l_us.*(L_c + x_s - 0.2e1./0.3e1.*delta_o).*(xi.^2) + (delta_o.^2) + ((-L_c - x_s).*delta_o) + (h_s.^2)).*(xi.^2).*l_ls.^2 + (-0.3e1./0.2e1.*(l_us.^2).*(L_c + x_s - delta_o./0.3e1).*(xi.^4) + ((delta_o.^2 + (-2.*L_c - 2.*x_s).*delta_o + h_s.^2).*l_us.*xi.^2) + (delta_o.^3)./0.2e1 + (-L_c./0.2e1 - x_s./0.2e1).*(delta_o.^2) + (h_s.^2.*delta_o)./0.2e1 + (h_s.^2.*(L_c + x_s))./0.2e1).*l_ls - (l_us.*(l_us.*xi.^2 + h_s + delta_o).*(-l_us.*xi.^2 + h_s - delta_o).*(L_c + x_s))./0.2e1).*cos(alpha).^2 - ((l_us.*xi.^2) - l_ls.*(xi.^2) + delta_o).^2.*((-L_c - x_s + delta_o).*l_ls + (l_us.*(L_c + x_s)))./0.2e1).*(cos(alpha) - 0.1e1).*xi.*(cos(alpha) + 0.1e1)).*sqrt(-((l_us.^2.*xi.^4 - 2.*xi.^2.*(L_c + x_s - delta_o).*l_us + L_c.^2 + (2.*x_s - 2.*delta_o).*L_c + h_s.^2 + x_s.^2 - 2.*x_s.*delta_o + delta_o.^2).*cos(alpha).^2 - ((l_us.*xi.^2 - L_c - x_s + delta_o).^2)).*l_ls.^2.*f_tu(xi).^2 + 0.2e1.*f_to(xi).*l_us.*l_ls.*(cos(alpha) - 0.1e1).*(cos(alpha) + 0.1e1).*(l_ls.*(xi.^2) - L_c - x_s).*(l_us.*xi.^2 - L_c - x_s + delta_o).*f_tu(xi) - (cos(alpha) - 0.1e1).*(cos(alpha) + 0.1e1).*(l_ls.*(xi.^2) - L_c - x_s).^2.*((l_us.^2).*f_to(xi).^2 + (h_s.^2))) + cos(alpha).*(((-l_ls.^3.*(l_us.^2.*xi.^4 - 2.*xi.^2.*(L_c + x_s - delta_o).*l_us + delta_o.^2 + (-2.*L_c - 2.*x_s).*delta_o + h_s.^2 + L_c.^2 + 2.*L_c.*x_s + x_s.^2).*f_tu(xi).^3 + 0.3e1.*f_to(xi).*l_us.*l_ls.^2.*(l_ls.*(xi.^2) - L_c - x_s).*(l_us.*xi.^2 - L_c - x_s + delta_o).*f_tu(xi).^2 + ((l_us.^2).*(-0.2e1.*l_ls.^2.*(xi.^4) - 0.2e1.*(xi.^2).*(l_us.*xi.^2 - 3.*L_c - 3.*x_s + delta_o).*l_ls + (l_us.^2.*xi.^4) + (2.*l_us.*xi.^2.*delta_o) + (h_s.^2) - (3.*L_c.^2) - (6.*L_c.*x_s) - (3.*x_s.^2) + (delta_o.^2)).*f_to(xi).^2 + (-(xi.^2).*(l_us.*xi.^2 - L_c - x_s + h_s + delta_o).*l_ls + (l_us.^2.*xi.^4) - (l_us.*(L_c + x_s - 2.*delta_o).*xi.^2) + (delta_o.^2) + ((-L_c - x_s).*delta_o) + (h_s.*(h_s + L_c + x_s))).*((xi.^2).*(-l_us.*xi.^2 + L_c + x_s + h_s - delta_o).*l_ls + (l_us.^2.*xi.^4) - (l_us.*(L_c + x_s - 2.*delta_o).*xi.^2) + (delta_o.^2) + ((-L_c - x_s).*delta_o) + (h_s.*(h_s - L_c - x_s)))).*l_ls.*f_tu(xi) - l_us.*f_to(xi).*(l_ls.*(xi.^2) - L_c - x_s).*((l_us.^2).*((l_us.*xi.^2) - 0.2e1.*l_ls.*(xi.^2) + L_c + x_s + delta_o).*f_to(xi).^2 + (xi.^4).*(l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls.^2 - 0.2e1.*(l_us.^2.*xi.^4 - l_us.*(L_c + x_s - 2.*delta_o).*xi.^2 + delta_o.^2 + (-L_c - x_s).*delta_o + h_s.^2).*(xi.^2).*l_ls + (xi.^6.*l_us.^3) - (l_us.^2.*(L_c + x_s - 3.*delta_o).*xi.^4) + ((3.*delta_o.^2 + (-2.*L_c - 2.*x_s).*delta_o + h_s.^2).*l_us.*xi.^2) + (delta_o.^3) + ((-L_c - x_s).*delta_o.^2) + (h_s.^2.*delta_o) + (h_s.^2.*(L_c + x_s)))).*cos(alpha).^4 + (l_ls.^3.*((l_us.*xi.^2 - L_c - x_s + delta_o).^2).*f_tu(xi).^3 - 0.3e1.*f_to(xi).*l_us.*l_ls.^2.*(l_ls.*(xi.^2) - L_c - x_s).*(l_us.*xi.^2 - L_c - x_s + delta_o).*f_tu(xi).^2 - 0.2e1.*((l_us.^2).*(-0.2e1.*l_ls.^2.*(xi.^4) - 0.2e1.*(xi.^2).*(l_us.*xi.^2 - 3.*L_c - 3.*x_s + delta_o).*l_ls + (l_us.^2.*xi.^4) + (2.*l_us.*xi.^2.*delta_o) + (delta_o.^2) - (3.*(L_c + x_s).^2)).*f_to(xi).^2./0.2e1 - (xi.^4).*(-2.*l_us.^2.*xi.^4 + 4.*xi.^2.*(L_c + x_s - delta_o).*l_us - 2.*delta_o.^2 + (4.*L_c + 4.*x_s).*delta_o + h_s.^2 - 2.*L_c.^2 - 4.*L_c.*x_s - 2.*x_s.^2).*l_ls.^2./0.2e1 - ((2.*xi.^6.*l_us.^3) - 0.4e1.*(l_us.^2).*(L_c + x_s - 0.3e1./0.2e1.*delta_o).*(xi.^4) + (l_us.*(6.*delta_o.^2 + (-8.*L_c - 8.*x_s).*delta_o + h_s.^2 + 2.*L_c.^2 + 4.*L_c.*x_s + 2.*x_s.^2).*xi.^2) + (2.*delta_o.^3) + ((-4.*L_c - 4.*x_s).*delta_o.^2) + ((2.*L_c.^2 + 4.*L_c.*x_s + 2.*x_s.^2 + h_s.^2).*delta_o) - (2.*h_s.^2.*(L_c + x_s))).*(xi.^2).*l_ls + (xi.^8.*l_us.^4) - (2.*l_us.^3.*(L_c + x_s - 2.*delta_o).*xi.^6) + (l_us.^2.*(6.*delta_o.^2 + (-6.*L_c - 6.*x_s).*delta_o + h_s.^2 + L_c.^2 + 2.*L_c.*x_s + x_s.^2).*xi.^4) - (l_us.*(2.*delta_o.^2 + (-2.*L_c - 2.*x_s).*delta_o + h_s.^2).*(L_c + x_s - 2.*delta_o).*xi.^2) + (delta_o.^4) + ((-2.*L_c - 2.*x_s).*delta_o.^3) + ((L_c.^2 + 2.*L_c.*x_s + x_s.^2 + h_s.^2).*delta_o.^2) - (h_s.^2.*(L_c + x_s).*delta_o) - (h_s.^2.*(L_c + x_s).^2)./0.2e1).*l_ls.*f_tu(xi) + l_us.*f_to(xi).*((l_us.^2).*((l_us.*xi.^2) - 0.2e1.*l_ls.*(xi.^2) + L_c + x_s + delta_o).*f_to(xi).^2 + 0.2e1.*(xi.^4).*(l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls.^2 - 0.2e1.*(2.*l_us.^2.*xi.^4 - 2.*l_us.*(L_c + x_s - 2.*delta_o).*xi.^2 + 2.*delta_o.^2 + (-2.*L_c - 2.*x_s).*delta_o + h_s.^2).*(xi.^2).*l_ls + (2.*xi.^6.*l_us.^3) - (2.*l_us.^2.*(L_c + x_s - 3.*delta_o).*xi.^4) + (l_us.*(6.*delta_o.^2 + (-4.*L_c - 4.*x_s).*delta_o + h_s.^2).*xi.^2) + (2.*delta_o.^3) + ((-2.*L_c - 2.*x_s).*delta_o.^2) + (h_s.^2.*delta_o) + (h_s.^2.*(L_c + x_s))).*(l_ls.*(xi.^2) - L_c - x_s)).*cos(alpha).^2 - (-(l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls.*f_tu(xi) + f_to(xi).*l_us.*(l_ls.*(xi.^2) - L_c - x_s)).*((l_us.*xi.^2) - l_ls.*(xi.^2) + delta_o).^2.*(l_us.*xi.^2 - L_c - x_s + delta_o)).*l_ls.*df_tu(xi) - 0.2e1.*((-l_ls.^3.*(-(xi.^2).*(l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls./0.2e1 + (l_us.^2.*xi.^4) - 0.3e1./0.2e1.*(L_c + x_s - 0.4e1./0.3e1.*delta_o).*l_us.*(xi.^2) + (delta_o.^2) + (-0.3e1./0.2e1.*L_c - 0.3e1./0.2e1.*x_s).*delta_o + (h_s.^2) + (L_c.^2)./0.2e1 + (L_c.*x_s) + (x_s.^2)./0.2e1).*f_tu(xi).^3 + l_us.*(-l_ls.^2.*(xi.^4)./0.2e1 + (xi.^2).*(l_us.*xi.^2 + delta_o).*l_ls + (l_us.^2.*xi.^4) - 0.3e1.*l_us.*(L_c + x_s - 0.2e1./0.3e1.*delta_o).*(xi.^2) + (delta_o.^2) + ((-3.*L_c - 3.*x_s).*delta_o) + 0.3e1./0.2e1.*(L_c.^2) + 0.3e1./0.2e1.*(x_s.^2) + (3.*L_c.*x_s) + (h_s.^2)).*f_to(xi).*l_ls.^2.*f_tu(xi).^2 + l_ls.*(-0.3e1.*(l_us.^2).*(l_us.*xi.^2 - L_c - x_s + delta_o).*f_to(xi).^2 + (xi.^4).*(l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls.^2 - 0.2e1.*(l_us.^2.*xi.^4 - l_us.*(L_c + x_s - 2.*delta_o).*xi.^2 + delta_o.^2 + (-L_c - x_s).*delta_o + h_s.^2).*(xi.^2).*l_ls + (xi.^6.*l_us.^3) - (l_us.^2.*(L_c + x_s - 3.*delta_o).*xi.^4) + ((3.*delta_o.^2 + (-2.*L_c - 2.*x_s).*delta_o + h_s.^2).*l_us.*xi.^2) + (delta_o.^3) + ((-L_c - x_s).*delta_o.^2) + (h_s.^2.*delta_o) + (h_s.^2.*(L_c + x_s))).*(l_ls.*(xi.^2) - L_c - x_s).*f_tu(xi)./0.2e1 + l_us.*f_to(xi).*((l_us.^2).*f_to(xi).^2 + ((l_us.*xi.^2) - l_ls.*(xi.^2) + h_s + delta_o).*(-(l_us.*xi.^2) + l_ls.*(xi.^2) + h_s - delta_o)).*(l_ls.*(xi.^2) - L_c - x_s).^2./0.2e1).*cos(alpha).^4 + ((l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls.^3.*((l_us.*xi.^2) - l_ls.*(xi.^2)./0.2e1 - L_c./0.2e1 - x_s./0.2e1 + delta_o).*f_tu(xi).^3 - (-l_ls.^2.*(xi.^4)./0.2e1 + (xi.^2).*(l_us.*xi.^2 + delta_o).*l_ls + (l_us.^2.*xi.^4) - 0.3e1.*l_us.*(L_c + x_s - 0.2e1./0.3e1.*delta_o).*(xi.^2) + (delta_o.^2) + ((-3.*L_c - 3.*x_s).*delta_o) + 0.3e1./0.2e1.*((L_c + x_s).^2)).*l_us.*f_to(xi).*l_ls.^2.*f_tu(xi).^2 - (-0.3e1.*(l_us.^2).*(l_us.*xi.^2 - L_c - x_s + delta_o).*f_to(xi).^2 + 0.2e1.*(xi.^4).*(l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls.^2 - 0.2e1.*(2.*l_us.^2.*xi.^4 - 2.*l_us.*(L_c + x_s - 2.*delta_o).*xi.^2 + 2.*delta_o.^2 + (-2.*L_c - 2.*x_s).*delta_o + h_s.^2).*(xi.^2).*l_ls + (2.*xi.^6.*l_us.^3) - (2.*l_us.^2.*(L_c + x_s - 3.*delta_o).*xi.^4) + (l_us.*(6.*delta_o.^2 + (-4.*L_c - 4.*x_s).*delta_o + h_s.^2).*xi.^2) + (2.*delta_o.^3) + ((-2.*L_c - 2.*x_s).*delta_o.^2) + (h_s.^2.*delta_o) + (h_s.^2.*(L_c + x_s))).*l_ls.*(l_ls.*(xi.^2) - L_c - x_s).*f_tu(xi)./0.2e1 - l_us.*f_to(xi).*((l_us.^2).*f_to(xi).^2 - 0.2e1.*l_ls.^2.*(xi.^4) + (4.*l_us.*xi.^4 + 4.*xi.^2.*delta_o).*l_ls - (2.*l_us.^2.*xi.^4) - (4.*l_us.*xi.^2.*delta_o) + (h_s.^2) - (2.*delta_o.^2)).*(l_ls.*(xi.^2) - L_c - x_s).^2./0.2e1).*cos(alpha).^2 - (-(l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls.*f_tu(xi) + f_to(xi).*l_us.*(l_ls.*(xi.^2) - L_c - x_s)).*((l_us.*xi.^2) - l_ls.*(xi.^2) + delta_o).^2.*(l_ls.*(xi.^2) - L_c - x_s)./0.2e1).*l_us.*df_to(xi) + 0.2e1.*((l_us.*l_ls.^4.*(l_us.*xi.^2 - L_c - x_s + delta_o).*f_tu(xi).^4 - 0.2e1.*l_us.*f_to(xi).*l_ls.^3.*(((l_us.*xi.^2) - L_c./0.2e1 - x_s./0.2e1 + delta_o./0.2e1).*l_ls + l_us.*((l_us.*xi.^2) - 0.3e1./0.2e1.*L_c - 0.3e1./0.2e1.*x_s + delta_o)).*f_tu(xi).^3 - (-(l_us.^2).*(l_ls.^2.*(xi.^2) + (4.*l_us.*xi.^2 - 3.*L_c - 3.*x_s + 2.*delta_o).*l_ls + (l_us.*(l_us.*xi.^2 - 3.*L_c - 3.*x_s + delta_o))).*f_to(xi).^2 + (l_us.^2.*xi.^4 - 3.*xi.^2.*(L_c + x_s - delta_o).*l_us + 2.*delta_o.^2 + (-4.*L_c - 4.*x_s).*delta_o + h_s.^2 + 2.*L_c.^2 + 4.*L_c.*x_s + 2.*x_s.^2).*(xi.^2).*l_ls.^2 + (-(2.*xi.^6.*l_us.^3) + (6.*l_us.^2.*(L_c + x_s - delta_o).*xi.^4) - 0.4e1.*(0.3e1./0.2e1.*(delta_o.^2) + (-0.5e1./0.2e1.*L_c - 0.5e1./0.2e1.*x_s).*delta_o + (h_s.^2) + (L_c.^2) + (2.*L_c.*x_s) + (x_s.^2)).*l_us.*(xi.^2) - (2.*delta_o.^3) + ((4.*L_c + 4.*x_s).*delta_o.^2) + ((-2.*L_c.^2 - 4.*L_c.*x_s - 2.*x_s.^2 - 2.*h_s.^2).*delta_o) + (h_s.^2.*(L_c + x_s))).*l_ls + ((xi.^6.*l_us.^3 - 3.*l_us.^2.*(L_c + x_s - delta_o).*xi.^4 + l_us.*(3.*delta_o.^2 + (-6.*L_c - 6.*x_s).*delta_o + h_s.^2 + 2.*L_c.^2 + 4.*L_c.*x_s + 2.*x_s.^2).*xi.^2 + delta_o.^3 + (-3.*L_c - 3.*x_s).*delta_o.^2 + (2.*L_c.^2 + 4.*L_c.*x_s + 2.*x_s.^2 + h_s.^2).*delta_o + h_s.^2.*(L_c + x_s)).*l_us)).*l_ls.^2.*f_tu(xi).^2 - 0.2e1.*l_us.*f_to(xi).*((l_us.^2).*(l_ls.^2.*(xi.^2) + ((l_us.*xi.^2) - 0.3e1./0.2e1.*L_c - 0.3e1./0.2e1.*x_s + delta_o./0.2e1).*l_ls - (l_us.*(L_c + x_s))./0.2e1).*f_to(xi).^2 - ((l_us.*xi.^2) - 0.3e1./0.2e1.*L_c - 0.3e1./0.2e1.*x_s + 0.3e1./0.2e1.*delta_o).*(xi.^4).*l_ls.^3 + ((2.*l_us.^2.*xi.^4) - 0.3e1./0.2e1.*l_us.*(L_c + x_s - 2.*delta_o).*(xi.^2) + (delta_o.^2) + ((L_c + x_s).*delta_o) + (h_s.^2) - (2.*L_c.^2) - (4.*L_c.*x_s) - (2.*x_s.^2)).*(xi.^2).*l_ls.^2 + (-(xi.^6.*l_us.^3) - 0.3e1./0.2e1.*(l_us.^2).*(L_c + x_s + delta_o).*(xi.^4) + (((-4.*L_c - 4.*x_s).*delta_o + h_s.^2 + 4.*L_c.^2 + 8.*L_c.*x_s + 4.*x_s.^2).*l_us.*xi.^2) + (delta_o.^3)./0.2e1 + (-0.5e1./0.2e1.*L_c - 0.5e1./0.2e1.*x_s).*(delta_o.^2) + ((2.*L_c.^2) + (2.*x_s.^2) + (4.*L_c.*x_s) + (h_s.^2)./0.2e1).*delta_o - 0.3e1./0.2e1.*(h_s.^2).*(L_c + x_s)).*l_ls - l_us.*(L_c + x_s).*(-(3.*l_us.^2.*xi.^4) + 0.4e1.*l_us.*(L_c + x_s - 0.3e1./0.2e1.*delta_o).*(xi.^2) - (3.*delta_o.^2) + ((4.*L_c + 4.*x_s).*delta_o) + (h_s.^2))./0.2e1).*l_ls.*f_tu(xi) + ((l_us.^2).*f_to(xi).^2 + (h_s.^2)).*((l_us.^2).*l_ls.*f_to(xi).^2 - l_ls.^3.*(xi.^4) + 0.2e1.*(xi.^2).*(l_us.*xi.^2 + L_c + x_s).*l_ls.^2 + (-l_us.^2.*xi.^4 - 4.*l_us.*(L_c + x_s).*xi.^2 + delta_o.^2 + (-2.*L_c - 2.*x_s).*delta_o + h_s.^2).*l_ls + (2.*l_us.*(l_us.*xi.^2 + delta_o).*(L_c + x_s))).*(l_ls.*(xi.^2) - L_c - x_s)).*cos(alpha).^2 + ((l_us.*xi.^2) - l_ls.*(xi.^2) + delta_o).*((l_us.*xi.^2 - L_c - x_s + delta_o).*l_ls.^2.*((-l_us.*xi.^2 + 2.*L_c + 2.*x_s - 2.*delta_o).*l_ls + ((l_us.*xi.^2 - 2.*L_c - 2.*x_s + delta_o).*l_us)).*f_tu(xi).^2 - 0.2e1.*l_us.*f_to(xi).*(-((l_us.*xi.^2) - 0.3e1./0.2e1.*L_c - 0.3e1./0.2e1.*x_s + 0.3e1./0.2e1.*delta_o).*(xi.^2).*l_ls.^2 + ((l_us.^2.*xi.^4) + (l_us.*xi.^2.*delta_o)./0.2e1 - 0.2e1.*(x_s - delta_o./0.4e1 + L_c).*(L_c + x_s - delta_o)).*l_ls - 0.3e1./0.2e1.*l_us.*((l_us.*xi.^2) - 0.4e1./0.3e1.*L_c - 0.4e1./0.3e1.*x_s + delta_o).*(L_c + x_s)).*l_ls.*f_tu(xi) + ((l_us.^2).*f_to(xi).^2 + (h_s.^2)).*(-l_ls.^2.*(xi.^2) + (l_us.*xi.^2 + 2.*L_c + 2.*x_s - delta_o).*l_ls - (2.*l_us.*(L_c + x_s))).*(l_ls.*(xi.^2) - L_c - x_s))).*(cos(alpha) - 0.1e1).*xi.*(cos(alpha) + 0.1e1)))./((f_tu(xi).^2.*l_ls.^2 - 0.2e1.*l_us.*l_ls.*f_to(xi).*f_tu(xi) + (l_us.^2).*f_to(xi).^2 + l_ls.^2.*(xi.^4) + (-2.*l_us.*xi.^4 - 2.*xi.^2.*delta_o).*l_ls + (l_us.^2.*xi.^4) + (2.*l_us.*xi.^2.*delta_o) + (h_s.^2) + (delta_o.^2)).*cos(alpha).^2 - ((l_us.*xi.^2) - l_ls.*(xi.^2) + delta_o).^2).^2;


% S = @(xi,eta) repmat([x_s;0;0],1,size(xi,2)) + [-(l_ls.*xi.^2+eta.*(delta_o+(l_us-l_ls).*xi.^2));
%                                                   l_ls.*f_tu(xi) + eta.*(l_us.*f_to(xi)-l_ls.*f_tu(xi));
%                                                   eta.*h_s];
dSdxi = @(xi,eta) [-(2*l_ls.*xi+eta.*(delta_o+2*(l_us-l_ls).*xi));
                   l_ls.*df_tu(xi) + eta.*(l_us.*df_to(xi)-l_ls.*df_tu(xi));
                   zeros(1,size(xi,2))];
dSdeta = @(xi,eta) [-(delta_o+(l_us-l_ls).*xi.^2);
                      l_us.*f_to(xi)-l_ls.*f_tu(xi);
                      h_s*ones(1,size(xi,2))];

dr1 = @(xi) dSdxi(xi,g(xi)) + dSdeta(xi,g(xi)).*repmat(dg(xi),3,1);

integrand = @(xi) norm2(dr1(xi).').';
arc = @(xi) integral(integrand,0,xi);
s = arc(xi);